# Linux Credential Hunting
---

## Configuration Files

### Web Application Configs

```bash
# PHP configs
find /var/www -name "config.php" -o -name "settings.php" -o -name "database.php" 2>/dev/null

# Read configs
cat /var/www/html/config.php
cat /var/www/html/wp-config.php
cat /var/www/html/includes/config.inc.php

# Search for database passwords
find /var/www -name "*.php" -o -name "*.config" 2>/dev/null | xargs grep -i "password\|db_pass" 2>/dev/null
```

### Database Configuration Files

```bash
# MySQL
cat /etc/mysql/my.cnf
cat ~/.my.cnf
cat /etc/mysql/mariadb.conf.d/*.cnf

# PostgreSQL
cat /etc/postgresql/*/main/pg_hba.conf
cat ~/.pgpass

# MongoDB
cat /etc/mongod.conf
```

### Application Configurations

```bash
# General config files
find / -name "*.conf" -o -name "*.config" -o -name "settings.yml" 2>/dev/null | xargs grep -i "password\|credential\|secret\|api_key" 2>/dev/null

# Common locations
/opt/*/config/
/etc/*/
/usr/local/etc/
```

---

## Command History Files

### Bash History

```bash
# Current user
cat ~/.bash_history | grep -i "password\|pass\|ssh\|mysql\|su"

# Root (if accessible)
cat /root/.bash_history 2>/dev/null | grep -i "password\|pass"

# All users
cat /home/*/.bash_history 2>/dev/null | grep -i "password\|pass\|ssh\|mysql"

# Look for:
# - ssh user@host (then try password on other systems)
# - mysql -u user -pPASSWORD
# - su - username (password typed next)
# - curl/wget with basic auth
```

### Other Shell Histories

```bash
# Zsh
cat ~/.zsh_history

# MySQL history
cat ~/.mysql_history

# Python history
cat ~/.python_history

# Redis history
cat ~/.rediscli_history
```

---

## SSH Keys and Authorized Keys

### Private Keys

```bash
# Find all private keys
find / -name "id_rsa" -o -name "id_ed25519" -o -name "id_ecdsa" 2>/dev/null

# Common locations
cat ~/.ssh/id_rsa
cat ~/.ssh/id_ed25519
cat /root/.ssh/id_rsa 2>/dev/null
find /home -name "id_rsa" 2>/dev/null

# Also check for .pem files
find / -name "*.pem" 2>/dev/null
```

### Authorized Keys (Shows Who Can Access)

```bash
# Your user
cat ~/.ssh/authorized_keys

# Root
cat /root/.ssh/authorized_keys 2>/dev/null

# All users
find /home -name "authorized_keys" 2>/dev/null -exec cat {} \;
```

### SSH Known Hosts (Shows Where This System Connects)

```bash
cat ~/.ssh/known_hosts
cat /root/.ssh/known_hosts 2>/dev/null

# Parse hostnames/IPs
cat ~/.ssh/known_hosts | cut -d' ' -f1
```

---

## Environment Variables

### Current Environment

```bash
# View all environment variables
env
printenv

# Look for passwords
env | grep -i "password\|pass\|secret\|key\|token"
```

### Process Environment Variables

```bash
# Check all running processes
cat /proc/*/environ | strings | grep -i "password\|pass"

# Specific process (if PID known)
cat /proc/PID/environ | tr '\0' '\n'
```

---

## Backup Files and Archives

### Find Backup Files

```bash
# Common backup extensions
find / -name "*.bak" -o -name "*.backup" -o -name "*.old" -o -name "*~" 2>/dev/null

# Common backup directories
ls -la /var/backups/
ls -la /backup/
ls -la /opt/backups/
ls -la /tmp/backup/

# Database dumps
find / -name "*.sql" -o -name "*.dump" 2>/dev/null
```

### Extract Credentials from Backups

```bash
# Search backup files
find /var/backups -type f -exec grep -l "password" {} \; 2>/dev/null

# Database backup files often contain:
grep "INSERT INTO users" backup.sql | head -10
```

---

## Log Files

### Application Logs

```bash
# Check logs for credentials
cat /var/log/apache2/access.log | grep -i "password\|pass="
cat /var/log/apache2/error.log | grep -i "password"

# MySQL logs
cat /var/log/mysql/mysql.log | grep -i "password"

# Auth logs (shows successful logins)
cat /var/log/auth.log | grep "Accepted"
```

### Custom Application Logs

```bash
# Find log files
find /var/log -type f -name "*.log" 2>/dev/null

# Search for passwords
find /var/log -type f -exec grep -l "password" {} \; 2>/dev/null
```

---

## Temporary and Cache Files

### /tmp Directory

```bash
# Check /tmp for scripts, configs
ls -la /tmp/
find /tmp -name "*.sh" -o -name "*.py" -o -name "*.conf" 2>/dev/null
```

### User Cache

```bash
# Browser cache (if GUI applications)
find ~/.cache -name "*.db" -o -name "*.sqlite" 2>/dev/null

# Application cache
ls -la ~/.cache/
```

---

## Credential Storage in Applications

### Git Repositories

```bash
# Find git repos
find / -name ".git" -type d 2>/dev/null

# Check git config
find / -name ".git" -type d -exec cat {}/.git/config \; 2>/dev/null

# Search commit history
cd /path/to/repo
git log --all --pretty=format:"%h %s" | grep -i "password\|credential"
git show COMMIT_HASH | grep -i "password"
```

### Docker

```bash
# Docker configs
cat ~/.docker/config.json

# Docker environment files
find /var/lib/docker -name "*.env" 2>/dev/null
```

---

## User-Specific Directories

### Home Directory Search

```bash
# Your user's home
find ~ -name "*.txt" -o -name "*.conf" -o -name "*.config" 2>/dev/null | xargs grep -i "password" 2>/dev/null

# Root's home (if accessible)
find /root -name "*.txt" -o -name "*.conf" 2>/dev/null | xargs grep -i "password" 2>/dev/null

# All users' homes
find /home -name "*.txt" -o -name "notes.txt" -o -name "passwords.txt" 2>/dev/null
```

---

## Database Files

### SQLite Databases

```bash
# Find SQLite databases
find / -name "*.db" -o -name "*.sqlite" -o -name "*.sqlite3" 2>/dev/null

# Read SQLite database
sqlite3 database.db .dump | grep -i "password\|user"
sqlite3 database.db "SELECT * FROM users;"
```

### MySQL Database Files

```bash
# MySQL data directory (if accessible)
ls -la /var/lib/mysql/

# Individual database directories
ls -la /var/lib/mysql/wordpress/
```

---

## Network Connection Information

### Find Credentials in Network Configs

```bash
# Network manager connections (may contain WiFi passwords)
ls -la /etc/NetworkManager/system-connections/
cat /etc/NetworkManager/system-connections/*

# VPN configs
find / -name "*.ovpn" -o -name "*.conf" 2>/dev/null | grep vpn
```

---

## Credential Hunting Workflow

### Systematic Approach (20 Minutes)

**Quick Wins**
```bash
cat ~/.bash_history | grep password
cat ~/.ssh/id_rsa
cat ~/.*_history | grep -i password
```

**Configuration Files**
```bash
find /var/www -name "config*" | xargs grep -i password
cat /etc/mysql/my.cnf
```

**SSH Keys**
```bash
find / -name "id_rsa" 2>/dev/null
find /home -name "authorized_keys" 2>/dev/null
```

**Comprehensive Search**
```bash
find / -name "*.conf" -o -name "*.config" 2>/dev/null | xargs grep -i "password" 2>/dev/null
```

**Save ALL found credentials to file:**
```bash
# Create credentials file
cat > found_credentials.txt << EOF
Source: ~/.bash_history
Username: admin
Password: AdminPass123!

Source: /var/www/html/config.php  
Username: dbuser
Password: DbPass2024!

Source: /home/user/.ssh/id_rsa
Key: [path to key file]
EOF
```

---

## Common Locations Summary

```
Configuration Files:
- /var/www/html/config.php
- /etc/mysql/my.cnf
- /opt/*/config/

Command Histories:
- ~/.bash_history
- /root/.bash_history
- ~/.mysql_history

SSH Keys:
- ~/.ssh/id_rsa
- /root/.ssh/id_rsa
- /home/*/.ssh/id_rsa

Backup Files:
- /var/backups/
- /*.bak, /*.backup

Logs:
- /var/log/auth.log
- /var/log/apache2/access.log
```

---
